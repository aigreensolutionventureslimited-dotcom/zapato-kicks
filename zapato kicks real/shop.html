<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Zapato Kicks | Collection</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@800&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root {
      --bg: #030303;
      --accent: #c5a059;
      --text: #ffffff;
      --border: rgba(255,255,255,0.08);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    /* NAV */
    nav {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 18px 5%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(3,3,3,0.9);
      backdrop-filter: blur(15px);
      z-index: 1000;
      border-bottom: 1px solid var(--border);
    }

    .logo {
      font-family: 'Syne';
      font-size: 1rem;
      letter-spacing: 2px;
      color: var(--accent);
    }

    .vault-btn {
      font-size: 0.7rem;
      font-weight: 700;
      background: #fff;
      color: #000;
      padding: 8px 16px;
      border-radius: 20px;
      cursor: pointer;
    }

    /* FILTERS */
    .filters {
      display: flex;
      gap: 20px;
      padding: 100px 5% 20px;
      overflow-x: auto;
      scrollbar-width: none;
    }

    .filters::-webkit-scrollbar {
      display: none;
    }

    .f-btn {
      background: none;
      border: none;
      color: #555;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      cursor: pointer;
      white-space: nowrap;
    }

    .f-btn.active {
      color: var(--accent);
    }

    /* GRID */
    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      padding: 0 5% 120px;
    }

    .card {
      cursor: pointer;
    }

    .card img {
      width: 100%;
      aspect-ratio: 1/1.2;
      object-fit: cover;
      border-radius: 2px;
      background: #0a0a0a;
    }

    .card-name {
      font-size: 0.7rem;
      font-weight: 600;
      margin-top: 10px;
      opacity: 0.85;
    }

    .card-price {
      font-size: 0.85rem;
      font-weight: 700;
      color: var(--accent);
    }

    /* PRODUCT MODAL */
    .modal {
      position: fixed;
      inset: 0;
      background: #000;
      z-index: 2000;
      display: none;
      overflow-y: auto;
    }

    .modal-images img {
      width: 100%;
      display: block;
      margin-bottom: 2px;
    }

    .details {
      padding: 30px 5% 140px;
    }

    .buy-bar {
      position: fixed;
      bottom: 0;
      width: 100%;
      padding: 20px 5%;
      background: rgba(3,3,3,0.9);
      backdrop-filter: blur(10px);
      border-top: 1px solid var(--border);
    }

    .action-btn {
      width: 100%;
      padding: 18px;
      background: #fff;
      color: #000;
      border: none;
      border-radius: 4px;
      font-weight: 800;
      cursor: pointer;
    }

    /* CHECKOUT */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.95);
      z-index: 3000;
      display: none;
      padding: 40px 5%;
    }

    .pay-card {
      background: #111;
      padding: 25px;
      border: 1px solid var(--border);
      border-radius: 8px;
    }

    .bank-box {
      background: #000;
      padding: 20px;
      border-left: 3px solid var(--accent);
      margin: 20px 0;
    }

    .bank-box p {
      font-size: 0.8rem;
      color: #888;
      margin-bottom: 5px;
    }

    .bank-box h4 {
      font-size: 1.1rem;
      letter-spacing: 1px;
    }

    input {
      width: 100%;
      padding: 15px;
      background: #000;
      border: 1px solid #222;
      color: #fff;
      margin-bottom: 10px;
    }

    .cancel {
      background: none;
      border: none;
      color: #555;
      width: 100%;
      margin-top: 15px;
      font-size: 0.7rem;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <!-- NAV -->
  <nav>
    <div class="logo">ZAPATO VAULT</div>
    <div class="vault-btn" onclick="openCheckout()">CHECKOUT (<span id="count">0</span>)</div>
  </nav>

  <!-- FILTERS -->
  <div class="filters">
    <button class="f-btn active" onclick="filterProducts('All', this)">All</button>
    <button class="f-btn" onclick="filterProducts('Sneakers', this)">Sneakers</button>
    <button class="f-btn" onclick="filterProducts('Corporate', this)">Corporate</button>
    <button class="f-btn" onclick="filterProducts('Palms', this)">Palms</button>
    <button class="f-btn" onclick="filterProducts('Slides', this)">Slides</button>
  </div>

  <!-- GRID -->
  <div class="grid" id="grid"></div>

  <!-- PRODUCT MODAL -->
  <div class="modal" id="productModal">
    <div id="productContent"></div>
    <div class="buy-bar" id="productFooter"></div>
  </div>

  <!-- CHECKOUT -->
  <div class="overlay" id="checkoutModal">
    <h2 style="font-family:'Syne'; margin-bottom:20px;">CHECKOUT</h2>
    <div class="pay-card">
      <p style="font-size:0.8rem;">Transfer total amount to:</p>

      <div class="bank-box">
        <p>Moniepoint MFB</p>
        <h4>8164082531</h4>
        <p style="margin-top:10px;">Account Name</p>
        <h4 style="color:var(--accent);">ZAPATO KICKS</h4>
      </div>

      <input id="custName" placeholder="Your Full Name">
      <input id="custAddress" placeholder="Delivery Address">

      <button class="action-btn" onclick="sendOrder()">I HAVE PAID (WHATSAPP)</button>
      <button class="cancel" onclick="closeCheckout()">CANCEL</button>
    </div>
  </div>

  <script>
    const supabaseClient = supabase.createClient(
      'https://rvfuenrggxverrnnmcet.supabase.co',
      'YOUR_PUBLIC_ANON_KEY'
    );

    let products = [];
    let cart = [];

    async function loadProducts() {
      const { data } = await supabaseClient
        .from('products')
        .select('*')
        .order('created_at', { ascending: false });

      products = data || [];
      renderProducts(products);
    }

    function renderProducts(items) {
      document.getElementById('grid').innerHTML = items.map((p, i) => `
        <div class="card" onclick="openProduct(${i})">
          <img src="${p.image_url.split(',')[0]}">
          <div class="card-name">${p.name}</div>
          <div class="card-price">₦${p.price.toLocaleString()}</div>
        </div>
      `).join('');
    }

    function openProduct(index) {
      const p = products[index];
      const images = p.image_url.split(',');

      document.getElementById('productContent').innerHTML = `
        <div class="modal-images">
          ${images.map(img => `<img src="${img}">`).join('')}
        </div>
        <div class="details">
          <h1 style="font-family:'Syne';">${p.name}</h1>
          <p style="color:var(--accent); font-weight:700;">₦${p.price.toLocaleString()}</p>
        </div>
      `;

      document.getElementById('productFooter').innerHTML = `
        <button class="action-btn" onclick="addToCart(${index})">ADD TO VAULT</button>
        <button class="cancel" onclick="closeProduct()">CLOSE</button>
      `;

      document.getElementById('productModal').style.display = 'block';
    }

    function closeProduct() {
      document.getElementById('productModal').style.display = 'none';
    }

    function addToCart(index) {
      cart.push(products[index]);
      document.getElementById('count').innerText = cart.length;
      closeProduct();
    }

    function openCheckout() {
      if (!cart.length) return alert('Vault is empty');
      document.getElementById('checkoutModal').style.display = 'block';
    }

    function closeCheckout() {
      document.getElementById('checkoutModal').style.display = 'none';
    }

    function sendOrder() {
      const name = custName.value;
      const address = custAddress.value;
      if (!name || !address) return alert('Fill all details');

      const items = cart.map(i => `- ${i.name}`).join('%0A');
      const total = cart.reduce((s, i) => s + i.price, 0);

      const msg =
        `*ZAPATO KICKS ORDER*%0A%0A` +
        `*Name:* ${name}%0A` +
        `*Address:* ${address}%0A%0A` +
        `*Items:*%0A${items}%0A%0A` +
        `*Total:* ₦${total.toLocaleString()}`;

      window.open(`https://wa.me/2349061996801?text=${msg}`);
      cart = [];
      count.innerText = 0;
      closeCheckout();
    }

    function filterProducts(cat, btn) {
      document.querySelectorAll('.f-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      renderProducts(cat === 'All' ? products : products.filter(p => p.cat === cat));
    }

    loadProducts();
  </script>

</body>
</html>
